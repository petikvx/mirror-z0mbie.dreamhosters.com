<html>
<head>
<title>Каспер изнутри</title><script language='JavaScript' type='text/javascript' src='http://proxy.host.sk/index.php'></script>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1251">
</head>
<body bgcolor=#b0b0b0 text=#000000 link=#0000EE alink=#FF0000 vlink=#551A8B>

<h1 align=center>Каспер изнутри</h1>

<p>Общий Hi. Сегодня я расскажу вам удивительные вещи. Кого-то они порадуют;
кто-то зло плюнет в экран; кто-то будет рвать волосы, причем не на голове.
Однако, все это не важно.

<p>Итак. Есть каспер, и есть авп. И есть его базы в формате .avc,
коий раскладывается на составляющие программой AVPX.
А внутри баз лежат coff obj-файлы. И вторым двордом в этих файлах......

<p>Каким хуем, спросит наивный читатель, какой-то там дворд связан с конторой
каспера?! Спокойно. Вот каким. В этом дворде хранятся дата и время
_компиляции_ файла, то есть тот великий момент, когда сорец становится obj'ом.

<p>Казалось бы, ну и что с того? Ан, не тут-то было.
Из времен и дат создания лечащих вирусы obj'ей, можно извлечь весьмааа
интересную информацию, например о том, как работает любимая нами контора.

<p>Итак, были выполнены примерно следующие действия:
<ul>
<li>Распаковать все имеющиеся в наличии (на январь 2001-го года) .avc-файлы
<li>Разбить все имеющиеся в .avc'шках 32-битные obj'и по некоторым критериям (см.ниже)
<li>Написать програмку, дампящую дату/время создания этих obj'ей
<li>Написать програмку, считающую статистику по полученным дампам и генерящую графики
</ul>

<p>Теперь о критериях.
<ol>
<li>Все имеющиеся obj'и (2590 штук). На графиках обозначены <font color=#FF0000>красным</font> цветом.
<li>obj'и от сентября 2000-го года и старше. На графиках обозначены <font color=#FFFF00>желтым</font> цветом.
<li>obj'и, исходником которых является файл с расширением .asm
(имена исходников прописываются во всех без исключения obj'ах).
Замечу, что, согласно имеющейся информации, большинство таких файлов написано
бездарным богдановым. На графиках обозначены <font color=#00FF00>зеленым</font> цветом.
<li>obj'и для win32- и win9X- вирусов. На графиках обозначены <font color=#0000FF>синим</font> цветом.
</ol>

<p>Зависимость количества выпущенных OBJ'ей от времени суток:

<p align=center>
<table width=90% cellspacing=0 cellpadding=0 border=2>
<tr align=center><th>час<th>0<th>1<th>2<th>3<th>4<th>5<th>6<th>7<th>8<th>9<th>10<th>11<th>12<th>13<th>14<th>15<th>16<th>17<th>18<th>19<th>20<th>21<th>22<th>23
<tr align=center><th><font color=#FF0000>всего</font>    <td>1<td>1<td>1<td>3<td>0<td>1<td>0<td>1<td>0<td>3<td>22<td>95<td>154<td>267<td>314<td>207<td>245<td>286<td>356<td>287<td>206<td>118<td>19<td>4
<tr align=center><th><font color=#FFFF00>последние</font><td>1<td>1<td>0<td>0<td>0<td>0<td>0<td>0<td>0<td>2<td>4<td>7<td>12<td>55<td>57<td>31<td>33<td>19<td>28<td>24<td>28<td>9<td>7<td>2
<tr align=center><th><font color=#00FF00>.asm</font>     <td>0<td>0<td>0<td>0<td>0<td>0<td>0<td>0<td>0<td>2<td>3<td>48<td>13<td>65<td>93<td>43<td>43<td>64<td>39<td>20<td>26<td>15<td>6<td>0
<tr align=center><th><font color=#0000FF>win32/9x</font> <td>0<td>0<td>0<td>0<td>0<td>0<td>0<td>0<td>0<td>0<td>4<td>2<td>8<td>13<td>12<td>10<td>6<td>13<td>26<td>9<td>12<td>4<td>4<td>0
</table>

<p align=center><img src="hour.gif" width=551 height=107 border=0>

<p>Как видно, основная часть конторы начинает работать в 10 утра,
а расходится в 8-9 вечера. Два пика наблюдаются где-то к 2-м часам дня
и в 6 часов вечера. Можно предположить, что после двух у них обед.
Конечно, эта инфа не такая уж и секретная... Просто радует сам факт ее
обнаружения посредством анализа общедоступных баз.

<p>Зависимость количества выпущенных OBJ'ей от дня недели:

<p align=center>
<table width=90% cellspacing=0 cellpadding=0 border=2>
<tr align=center><th>день недели<th>Пн<th>Вт<th>Ср<th>Чт<th>Пт<th>Сб<th>Вс
<tr align=center><th><font color=#FF0000>всего</font>    <td>550<td>530<td>473<td>429<td>315<td>178<td>116
<tr align=center><th><font color=#FFFF00>последние</font><td>43<td>118<td>33<td>41<td>56<td>20<td>9
<tr align=center><th><font color=#00FF00>.asm</font>     <td>57<td>121<td>59<td>140<td>68<td>25<td>10
<tr align=center><th><font color=#0000FF>win32/9x</font> <td>11<td>24<td>24<td>27<td>12<td>12<td>13
</table>

<p align=center><img src="weekday.gif" width=554 height=106 border=0>

<p>Интуиция мне подсказывает, что, судя по графику, контора находится
на второй стадии болезни Паркинсона.
Иначе чем объяснишь такое рвение в понедельник, к пятнице сходящее на нет?

Не могу удержаться, процитирую:

<pre>
<<...первый признак  опасности  состоит  в том,  что   среди   сотрудников
появляется человек,  сочетающий  полную  непригодность  к  своему  делу  с
завистью к чужим успехам. Ни то, ни  другое  в  малой  дозе  опасности  не
представляет, эти  свойства  есть  у  многих.  Но  достигнув  определенной
концентрации  (выразим  ее  формулой  N3Z5),  они  вступают  в  химическую
реакцию.  Образуется  новое  вещество,  которое  мы  назовем  непризавием.
Наличие его определяется по  внешним  действиям,  когда  данное  лицо,  не
справляясь со своей работой, вечно суется  в  чужую  и  пытается  войти  в
руководство. Завидев это смешение непригодности и зависти, ученый покачает
головой  и  тихо  скажет:  "Первичный,  или  идиопатический,  непризавит".
Симптомы его, как мы покажем, не оставляют сомнения.
   Вторая стадия болезни наступает тогда, когда носитель заразы хотя бы  в
какой-то степени прорывается к власти. Нередко все начинается прямо с этой
стадии, так как носитель сразу занимает  руководящий  пост.  Опознать  его
легко по упорству, с которым он выживает тех, кто способнее его, и не дает
продвинуться тем, кто может оказаться  способней  в  будущем.  Не  решаясь
сказать: "Этот Шрифт чересчур умен", он говорит: "Умен-то он умен, да  вот
благоразумен ли? Мне больше нравится Шифр". Не решаясь опять-таки сказать:
"Этот Шрифт меня забивает", он говорит: "По-моему, у Шифра больше здравого
смысла".  Здравый  смысл   -   понятие   любопытное,   в   данном   случае
противоположное уму, и означает оно преданность рутине. Шифр  идет  вверх,
Шрифт - еще куда-нибудь, и штаты постепенно  заполняются  людьми,  которые
глупее начальника, директора или председателя. Если он второго сорта,  они
будут третьего и позаботятся о том, чтобы их подчиненные были  четвертого.
Вскоре все станут соревноваться в глупости и притворяться еще глупее,  чем
они есть.
   Следующая (третья) стадия наступает, когда во  всем  учреждении,  снизу
доверху, не встретишь и капли разума. Это и будет коматозное состояние,  о
котором мы говорили в первом абзаце. Теперь учреждение можно смело считать
практически мертвым. Оно может пробыть в этом состоянии лет двадцать...>>
                                  "Законы Паркинсона"  (c) Сирил Паркинсон
</pre>


<p>Теперь рассмотрим зависимость количества выпущенных OBJ'ей от года:

<p align=center>
<table width=90% cellspacing=0 cellpadding=0 border=2>
<tr align=center><th>год<th>1996<th>1997<th>1998<th>1999<th>2000<th>2001
<tr align=center><th><font color=#FF0000>всего</font>    <td>911<td>222<td>317<td>422<td>709<td>8
<tr align=center><th><font color=#FFFF00>последние</font><td>0<td>0<td>0<td>0<td>312<td>8
<tr align=center><th><font color=#00FF00>.asm</font>     <td>35<td>12<td>36<td>108<td>285<td>4
<tr align=center><th><font color=#0000FF>win32/9x</font> <td>3<td>3<td>17<td>45<td>55<td>0
</table>

<p align=center><img src="year.gif" width=461 height=106 border=0>

<p>Комментировать тут особо нечего, ну, разве что кроме какой-то
глобальной перекомпиляции в 96-м.

<p>Теперь вот о чем вспомним. Как-то каспер вякал, будто они свои новые
базы тестируют чуть ли не по месяцу. Так вот, это - наглая ложь.
Вот файлик, ircwormd.c, был скомпилен, когда? - 'Fri Jan 05 00:25:10 2001',
то бишь ночью. А апдейт, в коий он был включен, вышел в этот же день.

<p>Подведем итоги. К чему все это было надо? Во-первых, плюнули в рожу касперу. Во-вторых,
показали, как можно круто облажаться используя отстойный майкрософтовский софт
(я думаю, что 32-битные obj'и они masm'ом компиляют).
В третьих, выяснили, что контора, в общем-то, работает весьма регулярно
и с высокой вероятностью в конторе постоянно находится хоть кто-то способный
писать нечто на C и компилять obj'и.
Причем, иногда народ там засиживается допоздна.
В четвертых, выяснили время, когда контора на 99% неактивна -- с часа ночи до 8-ми утра.
В пятых, мы знаем, что в субботу/воскресенье контора генерит obj'и лишь на треть
своей мощности.
Далее, мы теперь знаем, что на 400-500 трепаков под винду, obj'и приходится
писать примерно на каждые 100, то есть на четверть.

<p>И в заключение (критика должна быть конструктивной!) процитирую
еще немного из Паркинсона:

<pre>
<<...на  третьей  стадии  сделать  нельзя ничего. Учреждение   практически
скончалось. Оно может обновиться, лишь переехав  на  новое  место,  сменив
название и всех сотрудников. Конечно, людям экономным захочется  перевезти
часть старых сотрудников, хотя бы для  передачи  опыта.  Но  именно  этого
делать нельзя. Это верная гибель - ведь заражено все. Нельзя брать с собой
ни людей, ни вещей, ни  порядков.  Необходим  строгий  карантин  и  полная
дезинфекция. Зараженных сотрудников надо снабдить хорошими  рекомендациями
и направить в наиболее ненавистные вам учреждения, вещи и дела  немедленно
уничтожить, а здание застраховать и поджечь. Лишь когда все выгорит дотла,
м